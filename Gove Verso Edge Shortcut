# Define the URL, the shortcut name, and the log file path
$url = "https://nwkls.agverso.com/home?cid=NWKLS&lid=GOVE"
$shortcutName = "Gove Verso"
$logFile = "C:\shortcutCreationLog.txt"

# Get the desktop path
$desktopPath = [System.Environment]::GetFolderPath('Desktop')

# Define the full path for the shortcut
$shortcutPath = Join-Path -Path $desktopPath -ChildPath $shortcutName

try {
    # Create a WScript Shell Object
    $shell = New-Object -ComObject ("WScript.Shell")

    # Create the shortcut
    $shortcut = $shell.CreateShortcut($shortcutPath)

    # Set the properties for the shortcut
    # Point to Microsoft Edge and pass the URL as an argument
    $shortcut.TargetPath = "C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe"
    $shortcut.Arguments = $url

    # Optionally, you can specify the Edge icon
    # This path may vary based on Edge installation location and version
    $shortcut.IconLocation = "C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe,0" 

    $shortcut.Save()

    # Log success message
    Add-Content -Path $logFile -Value "Shortcut created successfully on $(Get-Date)"
}
catch {
    # Log the error message
    Add-Content -Path $logFile -Value "Error creating shortcut on $(Get-Date): $_"
}

